"use strict";(self.webpackChunkangular_15_example=self.webpackChunkangular_15_example||[]).push([[562],{1562:(z,f,l)=>{l.r(f),l.d(f,{OrderModule:()=>j});var o=l(433),c=l(6895),p=l(7859),a=l(590),e=l(8256),u=l(4786);function b(r,s){if(1&r&&(e.TgZ(0,"div",18)(1,"p")(2,"strong"),e._uU(3,"Date:"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"p")(6,"strong"),e._uU(7,"Total Sales:"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"p")(10,"strong"),e._uU(11,"Total Orders:"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"p")(14,"strong"),e._uU(15,"Last Updated:"),e.qZA(),e._uU(16),e.ALo(17,"date"),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(4),e.hij(" ",t.salesData.date,""),e.xp6(4),e.hij(" \u20b1",t.salesData.totalSales,""),e.xp6(4),e.hij(" ",t.salesData.totalOrders,""),e.xp6(4),e.hij(" ",e.xi3(17,4,t.salesData.lastUpdated,"short"),"")}}function Z(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1,"No sales data available for the selected date."),e.qZA())}function h(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"h5",12),e._uU(5,"Daily Sales"),e.qZA(),e.TgZ(6,"button",13),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeSalesModal())}),e.qZA()(),e.YNc(7,b,18,7,"div",14),e.YNc(8,Z,2,0,"ng-template",null,15,e.W1O),e.TgZ(10,"div",16)(11,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeSalesModal())}),e._uU(12,"Close"),e.qZA()()()()()}if(2&r){const t=e.MAs(9),i=e.oxw();e.xp6(7),e.Q6J("ngIf",i.salesData)("ngIfElse",t)}}function v(r,s){1&r&&e._UZ(0,"span",25)}function O(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,d=e.oxw();return e.KtG(d.processOrder(n.id))}),e.YNc(1,v,1,0,"span",24),e._uU(2," Process "),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("disabled",t.isProcessing),e.xp6(1),e.Q6J("ngIf",t.isProcessing)}}function T(r,s){1&r&&e._UZ(0,"span",25)}function q(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,d=e.oxw();return e.KtG(d.shipOrder(n.id))}),e.YNc(1,T,1,0,"span",24),e._uU(2," Ship "),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("disabled",t.isShipping),e.xp6(1),e.Q6J("ngIf",t.isShipping)}}function A(r,s){1&r&&e._UZ(0,"span",25)}function x(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,d=e.oxw();return e.KtG(d.deliverOrder(n.id))}),e.YNc(1,A,1,0,"span",24),e._uU(2," Deliver "),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("disabled",t.isDelivering),e.xp6(1),e.Q6J("ngIf",t.isDelivering)}}function C(r,s){1&r&&e._UZ(0,"span",25)}function U(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,d=e.oxw();return e.KtG(d.cancelOrder(n.id))}),e.YNc(1,C,1,0,"span",24),e._uU(2," Cancel "),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("disabled",t.isCancelling),e.xp6(1),e.Q6J("ngIf",t.isCancelling)}}const S=function(){return["pending","processing"]};function y(r,s){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"date"),e.qZA(),e.TgZ(18,"td"),e.YNc(19,O,3,2,"button",19),e.YNc(20,q,3,2,"button",20),e.YNc(21,x,3,2,"button",21),e.YNc(22,U,3,2,"button",22),e.qZA()()),2&r){const t=s.$implicit;e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(null==t.Product?null:t.Product.name),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij("$",t.totalAmount,""),e.xp6(2),e.Oqu(t.payment),e.xp6(2),e.Oqu(t.salesChannel),e.xp6(2),e.Oqu(t.orderStatus),e.xp6(2),e.Oqu(e.xi3(17,12,t.createdAt,"short")),e.xp6(3),e.Q6J("ngIf","pending"===t.orderStatus),e.xp6(1),e.Q6J("ngIf","processing"===t.orderStatus),e.xp6(1),e.Q6J("ngIf","shipped"===t.orderStatus),e.xp6(1),e.Q6J("ngIf",e.DdM(15,S).includes(t.orderStatus))}}function I(r,s){1&r&&(e.TgZ(0,"tr")(1,"td",29),e._uU(2,"No orders to display"),e.qZA()())}let J=(()=>{class r{constructor(t,i,n){this.orderService=t,this.alertService=i,this.salesService=n,this.isSalesModalOpen=!1}ngOnInit(){this.loadOrders()}loadOrders(){this.orderService.getAllOrders().pipe((0,a.P)()).subscribe(t=>this.orders=t)}cancelOrder(t){const i=this.orders.find(n=>n.id===t);i.isCancelling=!0,this.orderService.cancelOrder(t).pipe((0,a.P)()).subscribe({next:()=>{this.loadOrders(),this.alertService.success("Order cancelled successfully")},error:n=>{i.isCancelling=!1,this.alertService.error("Order is already shipped or delivered")}})}processOrder(t){const i=this.orders.find(n=>n.id===t);i.isProcessing=!0,this.orderService.processOrder(t).pipe((0,a.P)()).subscribe({next:()=>{this.loadOrders(),this.alertService.success("Order processed successfully")},error:n=>{i.isProcessing=!1,this.alertService.error(n.message||"Failed to process order")}})}shipOrder(t){const i=this.orders.find(n=>n.id===t);i.isShipping=!0,this.orderService.shipOrder(t).pipe((0,a.P)()).subscribe({next:()=>{this.loadOrders(),this.alertService.success("Order shipped successfully")},error:n=>{i.isShipping=!1,this.alertService.error(n.message||"Failed to ship order")}})}deliverOrder(t){const i=this.orders.find(n=>n.id===t);i.isDelivering=!0,this.orderService.deliverOrder(t).pipe((0,a.P)()).subscribe({next:()=>{this.loadOrders(),this.alertService.success("Order delivered successfully")},error:n=>{i.isDelivering=!1,this.alertService.error(n.message||"Failed to deliver order")}})}fetchSalesData(t){this.salesService.getDailySales(t).pipe((0,a.P)()).subscribe({next:i=>{this.salesData=i,this.isSalesModalOpen=!0},error:()=>{this.alertService.error("Failed to fetch sales data")}})}closeSalesModal(){this.isSalesModalOpen=!1,this.salesData=void 0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(u.px),e.Y36(u.c9),e.Y36(u.MD))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"mb-3"],["type","date",1,"form-control","d-inline-block","w-auto","me-2"],["salesDate",""],[1,"btn","btn-primary",3,"click"],["class","modal d-block","style","background: rgba(0,0,0,0.5);",4,"ngIf"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"modal","d-block",2,"background","rgba(0,0,0,0.5)"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],["class","modal-body",4,"ngIf","ngIfElse"],["noSalesData",""],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"modal-body"],["class","btn btn-sm btn-primary me-1",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-info me-1",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-success me-1",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-danger",3,"disabled","click",4,"ngIf"],[1,"btn","btn-sm","btn-primary","me-1",3,"disabled","click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"btn","btn-sm","btn-info","me-1",3,"disabled","click"],[1,"btn","btn-sm","btn-success","me-1",3,"disabled","click"],[1,"btn","btn-sm","btn-danger",3,"disabled","click"],["colspan","5",1,"text-center"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"h1"),e._uU(1,"Orders"),e.qZA(),e.TgZ(2,"div",0),e._UZ(3,"input",1,2),e.TgZ(5,"button",3),e.NdJ("click",function(){e.CHM(n);const m=e.MAs(4);return e.KtG(i.fetchSalesData(m.value))}),e._uU(6,"View Sales"),e.qZA()(),e.YNc(7,h,13,2,"div",4),e.TgZ(8,"table",5)(9,"thead")(10,"tr")(11,"th"),e._uU(12,"Order #"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Product"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Quantity"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Total Price"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Payment"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Order Type"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Status"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Date"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Actions"),e.qZA()()(),e.TgZ(29,"tbody"),e.YNc(30,y,23,16,"tr",6),e.YNc(31,I,3,0,"tr",7),e.qZA()()}2&t&&(e.xp6(7),e.Q6J("ngIf",i.isSalesModalOpen),e.xp6(23),e.Q6J("ngForOf",i.orders),e.xp6(1),e.Q6J("ngIf",!(null!=i.orders&&i.orders.length)))},dependencies:[c.sg,c.O5,c.uU],encapsulation:2}),r})();function N(r,s){if(1&r&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&r){const t=s.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE(" ",t.name," - \u20b1",t.price," ")}}function Q(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Product is required"),e.qZA())}function k(r,s){if(1&r&&(e.TgZ(0,"div",25),e.YNc(1,Q,2,0,"div",26),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.productId.errors.required)}}function F(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Quantity is required"),e.qZA())}function Y(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Quantity must be at least 1"),e.qZA())}function L(r,s){if(1&r&&(e.TgZ(0,"div",25),e.YNc(1,F,2,0,"div",26),e.YNc(2,Y,2,0,"div",26),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.quantity.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.quantity.errors.min)}}function P(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Shipping Address is required"),e.qZA())}function w(r,s){if(1&r&&(e.TgZ(0,"div",25),e.YNc(1,P,2,0,"div",26),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.shippingAddress.errors.required)}}function M(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Payment is required"),e.qZA())}function D(r,s){if(1&r&&(e.TgZ(0,"div",25),e.YNc(1,M,2,0,"div",26),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.payment.errors.required)}}function K(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1,"Type is required"),e.qZA())}function E(r,s){if(1&r&&(e.TgZ(0,"div",25),e.YNc(1,K,2,0,"div",26),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.salesChannel.errors.required)}}function $(r,s){1&r&&e._UZ(0,"span",27)}function B(r,s){1&r&&(e.TgZ(0,"div",28),e._UZ(1,"span",29),e.qZA())}const _=function(r){return{"is-invalid":r}};let g=(()=>{class r{constructor(t,i,n,d,m,H){this.formBuilder=t,this.route=i,this.router=n,this.orderService=d,this.productService=m,this.alertService=H,this.loading=!1,this.submitting=!1,this.submitted=!1,this.products=[]}ngOnInit(){this.id=this.route.snapshot.params.id,this.loadProducts(),this.form=this.formBuilder.group({productId:["",o.kI.required],quantity:[1,[o.kI.required,o.kI.min(1)]],payment:[o.kI.required],shippingAddress:["",o.kI.required],salesChannel:[o.kI.required],createdAt:[Date(),o.kI.required]}),this.title="Create Order",this.id&&(this.title="Edit Order",this.loading=!0,this.orderService.getOrderById(this.id).pipe((0,a.P)()).subscribe(t=>{this.form.patchValue(t),this.loading=!1}))}loadProducts(){this.productService.getProduct().pipe((0,a.P)()).subscribe(t=>{this.products=t.filter(i=>"active"===i.productStatus)})}onProductSelect(t){const i=this.products.find(n=>n.id===+t.target.value);i&&(this.form.get("quantity"),this.form.patchValue({price:i.price}))}get f(){return this.form.controls}onSubmit(){if(this.submitted=!0,this.alertService.clear(),this.form.invalid)return;let t,i;this.submitting=!0,this.id?(t=()=>this.orderService.updateOrder(this.id,this.form.value),i="Order updated"):(t=()=>this.orderService.createOrder(this.form.value),i="Order created"),t().pipe((0,a.P)()).subscribe({next:()=>{this.alertService.success(i,{keepAfterRouteChange:!0}),this.router.navigateByUrl("/order")},error:n=>{this.alertService.error(n),this.submitting=!1}})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(o.qu),e.Y36(p.gz),e.Y36(p.F0),e.Y36(u.px),e.Y36(u.M5),e.Y36(u.c9))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:53,vars:26,consts:[[3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col"],[1,"form-label"],["formControlName","productId",1,"form-control",3,"ngClass","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["for","quantity"],["type","number","formControlName","quantity","min","1",1,"form-control",3,"ngClass"],["formControlName","shippingAddress",1,"form-control",3,"ngClass"],[1,"mb-3","col-2"],["formControlName","payment",1,"form-select",3,"ngClass"],["value","Cash"],["value","Card"],["value","digitalWallet"],["formControlName","salesChannel",1,"form-select",3,"ngClass"],["value","online"],["value","walk-in"],[1,"mb-3"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","/order",1,"btn","btn-link"],["class","text-center m-5",4,"ngIf"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"text-center","m-5"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.TgZ(2,"form",0),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",1)(4,"div",2)(5,"label",3),e._uU(6,"Product"),e.qZA(),e.TgZ(7,"select",4),e.NdJ("change",function(d){return i.onProductSelect(d)}),e.TgZ(8,"option",5),e._uU(9,"Select a product"),e.qZA(),e.YNc(10,N,2,3,"option",6),e.qZA(),e.YNc(11,k,2,1,"div",7),e.qZA()(),e.TgZ(12,"div",1)(13,"div",2)(14,"label",8),e._uU(15,"Quantity"),e.qZA(),e._UZ(16,"input",9),e.YNc(17,L,3,2,"div",7),e.qZA()(),e.TgZ(18,"div",1)(19,"div",2)(20,"label",3),e._uU(21,"Shipping Address"),e.qZA(),e._UZ(22,"textarea",10),e.YNc(23,w,2,1,"div",7),e.qZA()(),e.TgZ(24,"div",11)(25,"label",3),e._uU(26,"Payment"),e.qZA(),e.TgZ(27,"select",12),e._UZ(28,"option",5),e.TgZ(29,"option",13),e._uU(30,"Cash"),e.qZA(),e.TgZ(31,"option",14),e._uU(32,"Card"),e.qZA(),e.TgZ(33,"option",15),e._uU(34,"digitalWallet"),e.qZA()(),e.YNc(35,D,2,1,"div",7),e.qZA(),e.TgZ(36,"div",11)(37,"label",3),e._uU(38,"Order Type"),e.qZA(),e.TgZ(39,"select",16),e._UZ(40,"option",5),e.TgZ(41,"option",17),e._uU(42,"online"),e.qZA(),e.TgZ(43,"option",18),e._uU(44,"walk-in"),e.qZA()(),e.YNc(45,E,2,1,"div",7),e.qZA(),e.TgZ(46,"div",19)(47,"button",20),e.YNc(48,$,1,0,"span",21),e._uU(49," Save "),e.qZA(),e.TgZ(50,"a",22),e._uU(51,"Cancel"),e.qZA()()(),e.YNc(52,B,2,0,"div",23)),2&t&&(e.xp6(1),e.Oqu(i.title),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(5),e.Q6J("ngClass",e.VKq(16,_,i.submitted&&i.f.productId.errors)),e.xp6(3),e.Q6J("ngForOf",i.products),e.xp6(1),e.Q6J("ngIf",i.submitted&&i.f.productId.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(18,_,i.submitted&&i.f.quantity.errors)),e.xp6(1),e.Q6J("ngIf",i.submitted&&i.f.quantity.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(20,_,i.submitted&&i.f.shippingAddress.errors)),e.xp6(1),e.Q6J("ngIf",i.submitted&&i.f.shippingAddress.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(22,_,i.submitted&&i.f.payment.errors)),e.xp6(8),e.Q6J("ngIf",i.submitted&&i.f.payment.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(24,_,i.submitted&&i.f.salesChannel.errors)),e.xp6(6),e.Q6J("ngIf",i.submitted&&i.f.salesChannel.errors),e.xp6(2),e.Q6J("disabled",i.submitting),e.xp6(1),e.Q6J("ngIf",i.submitting),e.xp6(4),e.Q6J("ngIf",i.loading))},dependencies:[c.mk,c.sg,c.O5,o._Y,o.YN,o.Kr,o.Fj,o.wV,o.EJ,o.JJ,o.JL,o.qQ,o.sg,o.u,p.rH],encapsulation:2}),r})();const G=[{path:"",component:J},{path:"add",component:g},{path:"edit/:id",component:g}];let V=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.Bz.forChild(G),p.Bz]}),r})(),j=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.ez,o.UX,V]}),r})()}}]);