"use strict";(self.webpackChunkangular_15_example=self.webpackChunkangular_15_example||[]).push([[782],{9782:(G,p,l)=>{l.r(p),l.d(p,{BranchesModule:()=>j});var s=l(433),u=l(6895),d=l(7859),o=l(590),e=l(8256),h=l(4786);function _(n,a){1&n&&e._UZ(0,"span",44)}function f(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"Deactivate"),e.qZA())}function v(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"Reactivate"),e.qZA())}function Z(n,a){1&n&&e._UZ(0,"span",44)}function B(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"Delete"),e.qZA())}function A(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,c=e.oxw();return e.KtG(c.deleteBranch(r.id))}),e.YNc(1,Z,1,0,"span",42),e.YNc(2,B,2,0,"span",12),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("disabled",t.isDeleting),e.xp6(1),e.Q6J("ngIf",t.isDeleting),e.xp6(1),e.Q6J("ngIf",!t.isDeleting)}}const T=function(n,a){return{"btn-danger":n,"btn-success":a}};function x(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",38),e._uU(2),e.qZA(),e.TgZ(3,"td",38),e._uU(4),e.qZA(),e.TgZ(5,"td",38),e._uU(6),e.qZA(),e.TgZ(7,"td",39)(8,"a",40),e._uU(9,"Edit"),e.qZA(),e.TgZ(10,"button",41),e.NdJ("click",function(){const c=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.toggleDeactivateReactivateBranch(c.id))}),e.YNc(11,_,1,0,"span",42),e.YNc(12,f,2,0,"span",12),e.YNc(13,v,2,0,"span",12),e.qZA(),e.YNc(14,A,3,3,"button",43),e.qZA()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.location),e.xp6(2),e.Oqu(t.branchStatus),e.xp6(2),e.MGl("routerLink","edit/",t.id,""),e.xp6(2),e.Q6J("ngClass",e.WLB(9,T,"deactivated"!==t.branchStatus,"deactivated"===t.branchStatus)),e.xp6(1),e.Q6J("ngIf",t.isDeactivating||t.isReactivating),e.xp6(1),e.Q6J("ngIf","deactivated"!==t.branchStatus),e.xp6(1),e.Q6J("ngIf","deactivated"===t.branchStatus),e.xp6(1),e.Q6J("ngIf","deactivated"===t.branchStatus)}}function C(n,a){1&n&&(e.TgZ(0,"tr")(1,"td",46),e._UZ(2,"span",47),e.qZA()())}function q(n,a){if(1&n&&(e.TgZ(0,"div",48),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.errorMessage," ")}}function U(n,a){if(1&n&&(e.TgZ(0,"div",49),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.successMessage," ")}}function S(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"(Deactivated)"),e.qZA())}function M(n,a){if(1&n&&(e.TgZ(0,"option",50),e._uU(1),e.YNc(2,S,2,0,"span",12),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id)("disabled","deactivated"===t.branchStatus),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf","deactivated"===t.branchStatus)}}function I(n,a){if(1&n&&(e.TgZ(0,"option",51),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE(" ",t.firstName,"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",t.role," ")}}function J(n,a){if(1&n&&(e.TgZ(0,"option",51),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function L(n,a){if(1&n&&(e.TgZ(0,"div",52)(1,"strong"),e._uU(2,"Error:"),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.hij(" ",t.errorMessage," ")}}function N(n,a){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.lnq(" ",t.firstName," ",t.lastName," ",t.role," ")}}function D(n,a){if(1&n&&(e.TgZ(0,"div",53)(1,"h4"),e._uU(2,"Branch Information"),e.qZA(),e.TgZ(3,"p")(4,"strong"),e._uU(5,"Name:"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"p")(8,"strong"),e._uU(9,"Location:"),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"p")(12,"strong"),e._uU(13,"Status:"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"h5"),e._uU(16,"Assigned Staff"),e.qZA(),e.TgZ(17,"ul"),e.YNc(18,N,2,3,"li",11),e.qZA()()),2&n){const t=e.oxw();e.xp6(6),e.hij(" ",t.branchDetails.name,""),e.xp6(4),e.hij(" ",t.branchDetails.location,""),e.xp6(4),e.hij(" ",t.branchDetails.branchStatus,""),e.xp6(4),e.Q6J("ngForOf",null==t.branchDetails?null:t.branchDetails.Accounts)}}let Q=(()=>{class n{constructor(t,i,r){this.branchService=t,this.accountService=i,this.alertService=r,this.selectedBranchId="",this.selectedAccountId="",this.errorMessage="",this.successMessage="",this.submitting=!1,this.loadingBranches=!0,this.loadingBranchDetails=!1}ngOnInit(){this.branchService.getAllBranches().pipe((0,o.P)()).subscribe(t=>{this.branches=t,this.loadingBranches=!1}),this.accountService.getAll().pipe((0,o.P)()).subscribe(t=>this.accounts=t)}resetSelection(){this.selectedBranchId="",this.selectedAccountId=""}toggleDeactivateReactivateBranch(t){const i=this.branches.find(r=>r.id===t);"deactivated"===i.branchStatus?this.reactivateBranch(t,i):this.deactivateBranch(t,i)}deactivateBranch(t,i){i.isDeactivating=!0,this.branchService.deactivateBranch(t).pipe((0,o.P)()).subscribe(()=>{i.branchStatus="deactivated",i.isDeactivating=!1})}reactivateBranch(t,i){i.isReactivating=!0,this.branchService.reactivateBranch(t).pipe((0,o.P)()).subscribe(()=>{i.branchStatus="active",i.isReactivating=!1})}deleteBranch(t){if(confirm("Are you sure you want to delete this branch?")){const i=this.branches.find(r=>r.id===t);i.isDeleting=!0,this.branchService.deleteBranch(t).pipe((0,o.P)()).subscribe(()=>{this.branches=this.branches.filter(r=>r.id!==t),this.alertService.success("Branch deleted successfully",{keepAfterRouteChange:!0})},r=>{i.isDeleting=!1,this.alertService.error("Error deleting branch")})}}assignUserToBranch(){if(this.errorMessage="",this.successMessage="",this.selectedBranchId&&this.selectedAccountId){const t=this.branches.find(i=>i.id===this.selectedBranchId);if(t&&"deactivated"===t.branchStatus)return this.errorMessage="Cannot assign user to a deactivated branch.",void setTimeout(()=>{this.errorMessage=""},3e3);this.branchService.assignUserToBranch(this.selectedBranchId,this.selectedAccountId).pipe((0,o.P)()).subscribe({next:()=>{this.successMessage="User assigned to branch successfully",this.errorMessage="",setTimeout(()=>this.successMessage="",3e3)},error:i=>{this.errorMessage=400===i.status?"Only a manager can be assigned to a branch":"User is already assigned or user is not a Manager",setTimeout(()=>{this.errorMessage=""},3e3)}})}else this.errorMessage="Please select both a branch and a user.",setTimeout(()=>{this.errorMessage=""},3e3)}openBranchDetailsModal(){const t=document.getElementById("branchDetailsModal");t&&(new bootstrap.Modal(t).show(),t.addEventListener("hidden.bs.modal",()=>{this.resetSelection()}))}getBranchDetails(){this.errorMessage="",this.selectedBranchId?(this.loadingBranchDetails=!0,this.branchService.getBranchById(this.selectedBranchId).pipe((0,o.P)()).subscribe({next:t=>{this.branchDetails=t,this.loadingBranchDetails=!1,this.errorMessage=""},error:()=>{this.loadingBranchDetails=!1,this.alertService.error("Error fetching branch details")}})):this.alertService.error("Please select a branch")}resetBranchDetails(){this.branchDetails=void 0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.bm),e.Y36(h.BR),e.Y36(h.c9))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:72,vars:14,consts:[[1,"p-4"],[1,"container"],[1,"row"],[1,"col"],["routerLink","add","data-bs-toggle","modal",1,"btn","btn-sm","btn-success","mb-2"],[1,"col-auto"],["type","button",1,"btn","btn-info","mb-2",3,"click"],["type","button","data-bs-toggle","modal","data-bs-target","#assignUserModal",1,"btn","btn-primary","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","10%"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","assignUserModal","tabindex","-1","aria-labelledby","assignUserModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","assignUserModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[3,"ngSubmit"],["assignForm","ngForm"],[1,"mb-3"],["for","branchSelect",1,"form-label"],["name","branchSelect","required","",1,"form-select",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["for","accountSelect",1,"form-label"],["name","accountSelect","required","",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],["id","branchDetailsModal","tabindex","-1","aria-labelledby","branchDetailsModalLabel","aria-hidden","true",1,"modal","fade"],["id","branchDetailsModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],["branchDetailsForm","ngForm"],["class","alert alert-danger mt-4",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"align-middle"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-primary","me-1",3,"routerLink"],[1,"btn","btn-sm","btn-put-branch","me-1",3,"ngClass","click"],["class","spinner-border spinner-border-sm",4,"ngIf"],["class","btn btn-sm btn-danger btn-delete-branch",3,"disabled","click",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],[1,"btn","btn-sm","btn-danger","btn-delete-branch",3,"disabled","click"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[3,"value","disabled"],[3,"value"],[1,"alert","alert-danger","mt-4"],[1,"mt-4"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"router-outlet"),e.TgZ(3,"h1"),e._uU(4,"Branches"),e.qZA(),e.TgZ(5,"div",1)(6,"div",2)(7,"div",3)(8,"a",4),e._uU(9,"Create Branch"),e.qZA()(),e.TgZ(10,"div",5)(11,"button",6),e.NdJ("click",function(){return i.openBranchDetailsModal()}),e._uU(12," Get Branch Details "),e.qZA()(),e.TgZ(13,"div",5)(14,"button",7),e._uU(15," Assign User to Branch "),e.qZA()()()(),e.TgZ(16,"table",8)(17,"thead")(18,"tr")(19,"th",9),e._uU(20,"Branch Name"),e.qZA(),e.TgZ(21,"th",9),e._uU(22,"Location"),e.qZA(),e.TgZ(23,"th",9),e._uU(24,"Status"),e.qZA(),e._UZ(25,"th",10),e.qZA()(),e.TgZ(26,"tbody"),e.YNc(27,x,15,12,"tr",11),e.YNc(28,C,3,0,"tr",12),e.qZA()(),e.TgZ(29,"div",13)(30,"div",14)(31,"div",15)(32,"div",16)(33,"h5",17),e._uU(34,"Assign User to Branch"),e.qZA(),e._UZ(35,"button",18),e.qZA(),e.TgZ(36,"div",19),e.YNc(37,q,2,1,"div",20),e.YNc(38,U,2,1,"div",21),e.TgZ(39,"form",22,23),e.NdJ("ngSubmit",function(){return i.assignUserToBranch()}),e.TgZ(41,"div",24)(42,"label",25),e._uU(43,"Select Branch"),e.qZA(),e.TgZ(44,"select",26),e.NdJ("ngModelChange",function(c){return i.selectedBranchId=c}),e.YNc(45,M,3,4,"option",27),e.qZA()(),e.TgZ(46,"div",24)(47,"label",28),e._uU(48,"Select User"),e.qZA(),e.TgZ(49,"select",29),e.NdJ("ngModelChange",function(c){return i.selectedAccountId=c}),e.YNc(50,I,2,3,"option",30),e.qZA()(),e.TgZ(51,"button",31),e._uU(52,"Assign"),e.qZA()()()()()(),e.TgZ(53,"div",32)(54,"div",14)(55,"div",15)(56,"div",16)(57,"h5",33),e._uU(58,"Branch Details"),e.qZA(),e.TgZ(59,"button",34),e.NdJ("click",function(){return i.resetBranchDetails()}),e.qZA()(),e.TgZ(60,"div",19)(61,"form",22,35),e.NdJ("ngSubmit",function(){return i.getBranchDetails()}),e.TgZ(63,"div",24)(64,"label",25),e._uU(65,"Select Branch"),e.qZA(),e.TgZ(66,"select",26),e.NdJ("ngModelChange",function(c){return i.selectedBranchId=c}),e.YNc(67,J,2,2,"option",30),e.qZA()(),e.TgZ(68,"button",31),e._uU(69,"Get Details"),e.qZA()(),e.YNc(70,L,4,1,"div",36),e.YNc(71,D,19,4,"div",37),e.qZA()()()()()()),2&t){const r=e.MAs(40);e.xp6(27),e.Q6J("ngForOf",i.branches),e.xp6(1),e.Q6J("ngIf",i.loadingBranches),e.xp6(9),e.Q6J("ngIf",i.errorMessage),e.xp6(1),e.Q6J("ngIf",i.successMessage),e.xp6(6),e.Q6J("ngModel",i.selectedBranchId),e.xp6(1),e.Q6J("ngForOf",i.branches),e.xp6(4),e.Q6J("ngModel",i.selectedAccountId),e.xp6(1),e.Q6J("ngForOf",i.accounts),e.xp6(1),e.Q6J("disabled",r.invalid||i.submitting),e.xp6(15),e.Q6J("ngModel",i.selectedBranchId),e.xp6(1),e.Q6J("ngForOf",i.branches),e.xp6(1),e.Q6J("disabled",!i.selectedBranchId),e.xp6(2),e.Q6J("ngIf",i.errorMessage),e.xp6(1),e.Q6J("ngIf",i.branchDetails&&!i.errorMessage)}},dependencies:[u.mk,u.sg,u.O5,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.Q7,d.lC,d.rH,s.On,s.F],encapsulation:2}),n})();function Y(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"Branch Name is required"),e.qZA())}function y(n,a){if(1&n&&(e.TgZ(0,"div",15),e.YNc(1,Y,2,0,"div",16),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.name.errors.required)}}function E(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"Location is required"),e.qZA())}function F(n,a){if(1&n&&(e.TgZ(0,"div",15),e.YNc(1,E,2,0,"div",16),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.location.errors.required)}}function k(n,a){1&n&&e._UZ(0,"span",17)}const m=function(n){return{"is-invalid":n}};function w(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"form",4),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onSubmit())}),e.TgZ(1,"div",5)(2,"div",6)(3,"label",7),e._uU(4,"Branch Name"),e.qZA(),e._UZ(5,"input",8),e.YNc(6,y,2,1,"div",9),e.qZA(),e.TgZ(7,"div",6)(8,"label",7),e._uU(9,"Location"),e.qZA(),e._UZ(10,"input",10),e.YNc(11,F,2,1,"div",9),e.qZA()(),e.TgZ(12,"div",11)(13,"button",12),e.YNc(14,k,1,0,"span",13),e._uU(15," Save "),e.qZA(),e.TgZ(16,"a",14),e._uU(17,"Cancel"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngClass",e.VKq(7,m,t.submitted&&t.f.name.errors)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.name.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(9,m,t.submitted&&t.f.location.errors)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.location.errors),e.xp6(2),e.Q6J("disabled",t.submitting),e.xp6(1),e.Q6J("ngIf",t.submitting)}}function O(n,a){1&n&&(e.TgZ(0,"div",18),e._UZ(1,"span",19),e.qZA())}let b=(()=>{class n{constructor(t,i,r,c,g){this.formBuilder=t,this.route=i,this.router=r,this.branchService=c,this.alertService=g,this.loading=!1,this.submitting=!1,this.submitted=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.form=this.formBuilder.group({name:["",s.kI.required],location:["",s.kI.required]}),this.title="Create Branch",this.id&&(this.title="Edit Branch",this.loading=!0,this.branchService.getBranchById(this.id).pipe((0,o.P)()).subscribe(t=>{this.form.patchValue(t),this.loading=!1}))}get f(){return this.form.controls}onSubmit(){if(this.submitted=!0,this.alertService.clear(),this.form.invalid)return;let t,i;this.submitting=!0,this.id?(t=()=>this.branchService.updateBranch(this.id,this.form.value),i="Branch updated"):(t=()=>this.branchService.createBranch(this.form.value),i="Branch created"),t().pipe((0,o.P)()).subscribe({next:()=>{this.alertService.success(i,{keepAfterRouteChange:!0}),this.router.navigateByUrl("/branch")},error:r=>{this.alertService.error(r),this.submitting=!1}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(d.gz),e.Y36(d.F0),e.Y36(h.bm),e.Y36(h.c9))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:7,vars:3,consts:[[1,"p-4"],[1,"container"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center m-5",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"mb-3","col-6"],[1,"form-label"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","location",1,"form-control",3,"ngClass"],[1,"mb-3"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","/branch",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"text-center","m-5"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"router-outlet")(3,"h1"),e._uU(4),e.qZA(),e.YNc(5,w,18,11,"form",2),e.YNc(6,O,2,0,"div",3),e.qZA()()()),2&t&&(e.xp6(4),e.Oqu(i.title),e.xp6(1),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",i.loading))},dependencies:[u.mk,u.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,d.lC,d.rH],encapsulation:2}),n})();const R=[{path:"",component:Q},{path:"add",component:b},{path:"edit/:id",component:b}];let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.Bz.forChild(R),d.Bz]}),n})(),j=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,s.UX,P,s.u5]}),n})()}}]);