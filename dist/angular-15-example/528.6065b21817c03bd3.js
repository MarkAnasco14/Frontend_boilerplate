"use strict";(self.webpackChunkangular_15_example=self.webpackChunkangular_15_example||[]).push([[528],{3528:(q,v,c)=>{c.r(v),c.d(v,{InventoryModule:()=>k});var d=c(433),a=c(6895),m=c(7859),l=c(590),t=c(8256),u=c(4786);function g(n,i){if(1&n&&(t.TgZ(0,"li",27)(1,"span")(2,"strong"),t._uU(3),t.qZA(),t._uU(4),t.qZA()()),2&n){const e=i.$implicit;t.xp6(3),t.Oqu(null==e.product?null:e.product.name),t.xp6(1),t.AsE(" - Current stock: ",e.quantity," (Below reorder point: ",e.reorderPoint,") ")}}function y(n,i){if(1&n&&(t.TgZ(0,"div",23)(1,"h4",24),t._uU(2,"Low Stock Alerts"),t.qZA(),t.TgZ(3,"ul",25),t.YNc(4,g,5,3,"li",26),t.qZA()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.lowStockItems)}}function f(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"span"),t._uU(5),t.qZA()(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td")(11,"span"),t._uU(12),t.qZA()(),t.TgZ(13,"td")(14,"button",28),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.selectInventory(s))}),t._uU(15," Pull Out "),t.qZA(),t.TgZ(16,"button",29),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.selectInventory(s))}),t._uU(17," Set Reorder Point "),t.qZA()()()}if(2&n){const e=i.$implicit;t.xp6(2),t.Oqu(null==e.product?null:e.product.name),t.xp6(2),t.Tol("badge "+("active"===(null==e.product?null:e.product.productStatus)?"bg-success":"bg-danger")),t.xp6(1),t.hij(" ",null==e.product?null:e.product.productStatus," "),t.xp6(2),t.Oqu(e.quantity),t.xp6(2),t.Oqu(e.reorderPoint),t.xp6(2),t.Tol("badge "+(e.quantity<=e.reorderPoint?"bg-danger":"bg-success")),t.xp6(1),t.hij(" ",e.quantity<=e.reorderPoint?"Low Stock":"In Stock"," ")}}function b(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p")(2,"strong"),t._uU(3,"Product:"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"div",30)(6,"label"),t._uU(7,"Quantity"),t.qZA(),t.TgZ(8,"input",31),t.NdJ("ngModelChange",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.updatedQuantity=r)}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.hij(" ",null==e.selectedInventory.product?null:e.selectedInventory.product.name,""),t.xp6(4),t.Q6J("ngModel",e.updatedQuantity)}}function I(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p")(2,"strong"),t._uU(3,"Product:"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"div",30)(6,"label"),t._uU(7,"Reorder Point"),t.qZA(),t.TgZ(8,"input",31),t.NdJ("ngModelChange",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.updatedReorderPoint=r)}),t.qZA(),t.TgZ(9,"small",32),t._uU(10," Alert will be triggered when stock falls below this level "),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.hij(" ",null==e.selectedInventory.product?null:e.selectedInventory.product.name,""),t.xp6(4),t.Q6J("ngModel",e.updatedReorderPoint)}}let _=(()=>{class n{constructor(e,o,r){this.inventoryService=e,this.productService=o,this.alertService=r,this.inventory=[],this.products=[],this.loading=!1,this.updatedQuantity="",this.updatedReorderPoint="",this.lowStockItems=[],this.showLowStockOnly=!1}ngOnInit(){this.loadInventory(),this.loadLowStockItems()}loadInventory(){this.loading=!0,this.inventoryService.getInventory().pipe((0,l.P)()).subscribe({next:e=>{this.productService.getProduct().pipe((0,l.P)()).subscribe({next:o=>{this.products=o,this.inventory=e.map(r=>({...r,product:o.find(s=>s.id===r.productId)})),this.loading=!1},error:()=>{this.alertService.error("Failed to load products"),this.loading=!1}})},error:()=>{this.alertService.error("Failed to load inventory"),this.loading=!1}})}loadLowStockItems(){this.inventoryService.getLowStock().pipe((0,l.P)()).subscribe({next:e=>{this.productService.getProduct().pipe((0,l.P)()).subscribe({next:o=>{this.products=o,this.lowStockItems=e.map(r=>({...r,product:o.find(s=>s.id===r.productId)})),this.loading=!1},error:()=>{this.alertService.error("Failed to load products"),this.loading=!1}})},error:()=>{this.alertService.error("Failed to load low stock items")}})}selectInventory(e){this.selectedInventory=e,this.updatedQuantity=e.quantity,this.updatedReorderPoint=e.reorderPoint.toString()}updateStock(){if(!this.selectedInventory)return;const e=Number(this.selectedInventory.productId),o=Number(this.updatedQuantity);isNaN(e)||isNaN(o)?this.alertService.error("Invalid input: Ensure quantity is numeric"):this.inventoryService.updateStock(e,o).pipe((0,l.P)()).subscribe({next:()=>{this.alertService.success("Stock updated successfully"),this.loadInventory(),this.loadLowStockItems(),this.closeModal("updateStockModal")},error:r=>{this.alertService.error("Error updating stock: "+r)}})}updateReorderPoint(){if(!this.selectedInventory)return;const e=Number(this.selectedInventory.productId),o=Number(this.updatedReorderPoint);isNaN(e)||isNaN(o)?this.alertService.error("Invalid input: Ensure reorder point is numeric"):this.inventoryService.setReorderPoint(e,o).pipe((0,l.P)()).subscribe({next:()=>{this.alertService.success("Reorder point updated successfully"),this.loadInventory(),this.closeModal("reorderPointModal")},error:r=>{this.alertService.error("Error updating reorder point: "+r)}})}toggleLowStockFilter(){this.showLowStockOnly=!this.showLowStockOnly,this.showLowStockOnly?this.loadLowStockItems():this.loadInventory()}closeModal(e){const o=document.getElementById(e);o&&bootstrap.Modal.getInstance(o).hide(),this.selectedInventory=void 0,this.updatedQuantity="",this.updatedReorderPoint=""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.V7),t.Y36(u.M5),t.Y36(u.c9))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:56,vars:5,consts:[[1,"p-4"],[1,"container"],[1,"stock"],[1,"mb-3"],[1,"btn","btn-outline-primary","me-2",3,"click"],["class","alert alert-warning mb-3",4,"ngIf"],[1,"card"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["id","updateStockModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","reorderPointModal","tabindex","-1",1,"modal","fade"],[1,"alert","alert-warning","mb-3"],[1,"alert-heading"],[1,"list-unstyled","mb-0"],["class","d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center"],["data-bs-toggle","modal","data-bs-target","#updateStockModal",1,"btn","btn-sm","btn-primary","me-1",3,"click"],["data-bs-toggle","modal","data-bs-target","#reorderPointModal",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"form-group"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-text","text-muted"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"Stock Management"),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return o.toggleLowStockFilter()}),t._uU(6),t.qZA()(),t.YNc(7,y,5,1,"div",5),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"table",9)(12,"thead")(13,"tr")(14,"th"),t._uU(15,"Product Name"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Status"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Quantity"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Reorder Point"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Stock Status"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Actions"),t.qZA()()(),t.TgZ(26,"tbody"),t.YNc(27,f,18,9,"tr",10),t.qZA()()()()()()(),t.TgZ(28,"div",11)(29,"div",12)(30,"div",13)(31,"div",14)(32,"h5",15),t._uU(33,"Pull back to Warehouse"),t.qZA(),t._UZ(34,"button",16),t.qZA(),t.TgZ(35,"div",17),t.YNc(36,b,9,2,"div",18),t.qZA(),t.TgZ(37,"div",19)(38,"button",20),t._uU(39,"Cancel"),t.qZA(),t.TgZ(40,"button",21),t.NdJ("click",function(){return o.updateStock()}),t._uU(41,"Save"),t.qZA()()()()(),t.TgZ(42,"div",22)(43,"div",12)(44,"div",13)(45,"div",14)(46,"h5",15),t._uU(47,"Set Reorder Point"),t.qZA(),t._UZ(48,"button",16),t.qZA(),t.TgZ(49,"div",17),t.YNc(50,I,11,2,"div",18),t.qZA(),t.TgZ(51,"div",19)(52,"button",20),t._uU(53,"Cancel"),t.qZA(),t.TgZ(54,"button",21),t.NdJ("click",function(){return o.updateReorderPoint()}),t._uU(55,"Save"),t.qZA()()()()()),2&e&&(t.xp6(6),t.hij(" ",o.showLowStockOnly?"Show All Stock":"Show Low Stock Only"," "),t.xp6(1),t.Q6J("ngIf",o.showLowStockOnly&&o.lowStockItems.length>0),t.xp6(20),t.Q6J("ngForOf",o.inventory),t.xp6(9),t.Q6J("ngIf",o.selectedInventory),t.xp6(14),t.Q6J("ngIf",o.selectedInventory))},dependencies:[a.sg,a.O5,d.Fj,d.wV,d.JJ,d.On],styles:[".stock[_ngcontent-%COMP%]{\n        font-size: 18px;\n        font-weight: 500;\n    }"]}),n})(),h=(()=>{class n{constructor(e,o,r,s){this.inventoryService=e,this.alertService=o,this.formBuilder=r,this.productService=s,this.inventory=[],this.loading=!1,this.submitting=!1,this.submitted=!1,this.products=[]}ngOnInit(){this.loadProducts(),this.form=this.formBuilder.group({productId:["",d.kI.required],quantity:[0,[d.kI.required,d.kI.min(0)]]})}loadProducts(){this.productService.getProduct().pipe((0,l.P)()).subscribe(e=>{this.products=e.filter(o=>"active"===o.productStatus)})}selectInventory(e){this.selectedInventory=e,this.form.patchValue({quantity:e.quantity})}onUpdate(){if(this.submitted=!0,this.alertService.clear(),this.form.invalid||!this.selectedInventory)return;this.submitting=!0;const e=Number(this.selectedInventory.productId),o=Number(this.form.value.quantity);if(isNaN(e)||isNaN(o))return this.alertService.error("Invalid input: Ensure quantity and productId are numeric"),void(this.submitting=!1);this.inventoryService.updateStock(e,o).pipe((0,l.P)()).subscribe({next:()=>{this.alertService.success("Stock updated successfully"),this.loadProducts(),this.submitting=!1},error:r=>{this.alertService.error("Error updating stock: "+r),this.submitting=!1}})}clearSelection(){this.selectedInventory=void 0,this.form.reset({quantity:0})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.V7),t.Y36(u.c9),t.Y36(d.qu),t.Y36(u.M5))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"container"],[1,"stock"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Stock Management"),t.qZA()())},styles:[".stock[_ngcontent-%COMP%]{\n        font-size: 18px;\n        font-weight: 500;\n    }"]}),n})();const S=[{path:"",component:_},{path:"add",component:h},{path:"edit/:id",component:h}];let Z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(S),m.Bz]}),n})(),k=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[a.ez,d.UX,Z,d.u5]}),n})()}}]);